<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Black thursday</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.1/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.1/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.1/favicon_green.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.1/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.1/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2017-07-31T21:17:39-06:00">2017-07-31T21:17:39-06:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="green">98.58%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         151583.93
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>16</b> files in total.
    <b>632</b> relevant lines. 
    <span class="green"><b>623</b> lines covered</span> and
    <span class="red"><b>9</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#6098e1b2aa8c848905c6d6898d2e599b22c3a550" class="src_link" title="lib/calculator.rb">lib/calculator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>69</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>1240.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c20c1a31f4f3a53eec57c7ffba42b73758e953df" class="src_link" title="lib/customer.rb">lib/customer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>6805.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ea1a43bd51880d2a0b3fe16650215507d5fea189" class="src_link" title="lib/customer_repository.rb">lib/customer_repository.rb</a></td>
        <td class="green strong">96.77 %</td>
        <td>56</td>
        <td>31</td>
        <td>30</td>
        <td>1</td>
        <td>2828.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#810e6b3e9658c0835dde527f61952cc51a719b9d" class="src_link" title="lib/invoice.rb">lib/invoice.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>59</td>
        <td>30</td>
        <td>30</td>
        <td>0</td>
        <td>14090.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5d313736edf88a18e6d2769e0eca890134192374" class="src_link" title="lib/invoice_item.rb">lib/invoice_item.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>161473.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9e56dbf73d9637711968f6d02401065fa4ad41e4" class="src_link" title="lib/invoice_item_repository.rb">lib/invoice_item_repository.rb</a></td>
        <td class="green strong">96.77 %</td>
        <td>56</td>
        <td>31</td>
        <td>30</td>
        <td>1</td>
        <td>88163.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#91e90f2c7f3d5b104608b81536243eef13f3f510" class="src_link" title="lib/invoice_repository.rb">lib/invoice_repository.rb</a></td>
        <td class="green strong">97.22 %</td>
        <td>70</td>
        <td>36</td>
        <td>35</td>
        <td>1</td>
        <td>2400368.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#325531b5c612c5244e32fe2420831ae655b2f596" class="src_link" title="lib/item.rb">lib/item.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>34</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>8601.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#697c08fe4e249c73626b06f67c2f1db4f71fd6cd" class="src_link" title="lib/item_repository.rb">lib/item_repository.rb</a></td>
        <td class="green strong">97.14 %</td>
        <td>68</td>
        <td>35</td>
        <td>34</td>
        <td>1</td>
        <td>56080.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f72e5a51272f54137c5a15a83456c458388d684a" class="src_link" title="lib/loader.rb">lib/loader.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>52</td>
        <td>33</td>
        <td>33</td>
        <td>0</td>
        <td>20851.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4150a4dab4aba54017e8fd31239fb8520c82d866" class="src_link" title="lib/merchant.rb">lib/merchant.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>27</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>2572.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d91e41168837f41f9a545441447274cb377d7178" class="src_link" title="lib/merchant_repository.rb">lib/merchant_repository.rb</a></td>
        <td class="green strong">96.67 %</td>
        <td>58</td>
        <td>30</td>
        <td>29</td>
        <td>1</td>
        <td>141.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c165f8f1e439e50d51675a78b325e296fe747620" class="src_link" title="lib/sales_analyst.rb">lib/sales_analyst.rb</a></td>
        <td class="green strong">98.32 %</td>
        <td>309</td>
        <td>179</td>
        <td>176</td>
        <td>3</td>
        <td>54.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#faffb49bd05f238e2cbf2a87f2077ae98e0836be" class="src_link" title="lib/sales_engine.rb">lib/sales_engine.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>154</td>
        <td>84</td>
        <td>84</td>
        <td>0</td>
        <td>592.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8cbea7df2b292223c8a266b837b0512a23dc93da" class="src_link" title="lib/transaction.rb">lib/transaction.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>27</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>37084.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ff1e803e4ac601497a537845851cded6006f66f3" class="src_link" title="lib/transaction_repository.rb">lib/transaction_repository.rb</a></td>
        <td class="green strong">97.22 %</td>
        <td>66</td>
        <td>36</td>
        <td>35</td>
        <td>1</td>
        <td>15077.6</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.14.1 
        and simplecov-html v0.10.1<br/>
        using Unit Tests
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="6098e1b2aa8c848905c6d6898d2e599b22c3a550">
  <div class="header">
    <h3>lib/calculator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Calculator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def number_of_items_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="4">
          <span class="hits">3</span>
          
          <code class="ruby">    @se.call_merchants.map do |merchant_obj|</code>
        </li>
      
        <li class="covered" data-hits="501" data-linenumber="5">
          <span class="hits">501</span>
          
          <code class="ruby">      merchant_id = merchant_obj.id</code>
        </li>
      
        <li class="covered" data-hits="501" data-linenumber="6">
          <span class="hits">501</span>
          
          <code class="ruby">      items = @se.items.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="501" data-linenumber="7">
          <span class="hits">501</span>
          
          <code class="ruby">      items.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_variance_merchants(merchant_items)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="12">
          <span class="hits">3</span>
          
          <code class="ruby">    average = average_items_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="13">
          <span class="hits">3</span>
          
          <code class="ruby">    merchant_items.map do |num|</code>
        </li>
      
        <li class="covered" data-hits="491" data-linenumber="14">
          <span class="hits">491</span>
          
          <code class="ruby">      (num - average)**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_all_costs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_items.map do |item_obj|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="20">
          <span class="hits">11</span>
          
          <code class="ruby">      item_obj.unit_price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_all_costs(all_costs)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    (all_costs.sum / all_costs.length).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_variance_item_costs(all_costs)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    average = average_all_costs(all_costs)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    all_costs.map do |num|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="31">
          <span class="hits">11</span>
          
          <code class="ruby">      (num - average)**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_price_per_item</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    total_cost = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_items.each do |item|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="38">
          <span class="hits">11</span>
          
          <code class="ruby">      total_cost &lt;&lt; item.unit_price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    (total_cost.sum / @se.call_items.count.to_f).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def number_of_invoices_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="44">
          <span class="hits">3</span>
          
          <code class="ruby">    @se.call_invoices.map do |invoice_obj|</code>
        </li>
      
        <li class="covered" data-hits="14955" data-linenumber="45">
          <span class="hits">14955</span>
          
          <code class="ruby">      merchant_id = invoice_obj.merchant_id</code>
        </li>
      
        <li class="covered" data-hits="14955" data-linenumber="46">
          <span class="hits">14955</span>
          
          <code class="ruby">      invoices = @se.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="14955" data-linenumber="47">
          <span class="hits">14955</span>
          
          <code class="ruby">      invoices.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_squares_invoices(merchant_invoices)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    average = average_invoices_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="53">
          <span class="hits">3</span>
          
          <code class="ruby">    @se.call_merchants.map do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="1425" data-linenumber="54">
          <span class="hits">1425</span>
          
          <code class="ruby">      (merchant.invoices.count - average)**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_day</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="59">
          <span class="hits">6</span>
          
          <code class="ruby">    (@se.call_invoices.count / 7.0).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_squares_invoices_per_day(invoices_hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    average = average_invoices_per_day</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_hash.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="65">
          <span class="hits">5</span>
          
          <code class="ruby">      (invoice[1] - average)**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c20c1a31f4f3a53eec57c7ffba42b73758e953df">
  <div class="header">
    <h3>lib/customer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Customer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">              :first_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">              :last_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :cr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, first_name, last_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">                created_at, updated_at, cr)</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="11">
          <span class="hits">12475</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="12">
          <span class="hits">12475</span>
          
          <code class="ruby">    @first_name = first_name</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="13">
          <span class="hits">12475</span>
          
          <code class="ruby">    @last_name = last_name</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="14">
          <span class="hits">12475</span>
          
          <code class="ruby">    @created_at = Time.parse(created_at)</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="15">
          <span class="hits">12475</span>
          
          <code class="ruby">    @updated_at = Time.parse(updated_at)</code>
        </li>
      
        <li class="covered" data-hits="12475" data-linenumber="16">
          <span class="hits">12475</span>
          
          <code class="ruby">    @cr = cr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    cr.fetch_merchants_from_customer_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ea1a43bd51880d2a0b3fe16650215507d5fea189">
  <div class="header">
    <h3>lib/customer_repository.rb</h3>
    <h4><span class="green">96.77 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;customer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class CustomerRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :customers,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(customers_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="10">
          <span class="hits">55</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="11">
          <span class="hits">55</span>
          
          <code class="ruby">    @customers = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="12">
          <span class="hits">55</span>
          
          <code class="ruby">    contents = CSV.open customers_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                        headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                        header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="15">
          <span class="hits">55</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="16">
          <span class="hits">12473</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="17">
          <span class="hits">12473</span>
          
          <code class="ruby">      first_name = row[:first_name]</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="18">
          <span class="hits">12473</span>
          
          <code class="ruby">      last_name = row[:last_name]</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="19">
          <span class="hits">12473</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="20">
          <span class="hits">12473</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="21">
          <span class="hits">12473</span>
          
          <code class="ruby">      customer = Customer.new(id, first_name, last_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">                            created_at, updated_at, self)</code>
        </li>
      
        <li class="covered" data-hits="12473" data-linenumber="23">
          <span class="hits">12473</span>
          
          <code class="ruby">      @customers &lt;&lt; customer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    @customers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="32">
          <span class="hits">6</span>
          
          <code class="ruby">    @customers.find do |customer_obj|</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="33">
          <span class="hits">38</span>
          
          <code class="ruby">      customer_obj.id == customer_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_first_name(fragment)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="38">
          <span class="hits">4</span>
          
          <code class="ruby">    @customers.find_all do |customer|</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="39">
          <span class="hits">44</span>
          
          <code class="ruby">      customer.first_name.downcase.include?(fragment.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_last_name(fragment)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="44">
          <span class="hits">4</span>
          
          <code class="ruby">    @customers.find_all do |customer|</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="45">
          <span class="hits">44</span>
          
          <code class="ruby">      customer.last_name.downcase.include?(fragment.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchants_from_customer_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    se.fetch_merchants_from_customer_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@customers.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="810e6b3e9658c0835dde527f61952cc51a719b9d">
  <div class="header">
    <h3>lib/invoice.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Invoice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">              :customer_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :status,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :merchant_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :inr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, customer_id, status,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                 created_at, updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                 merchant_id, inr)</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="14">
          <span class="hits">60381</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="15">
          <span class="hits">60381</span>
          
          <code class="ruby">    @customer_id = customer_id</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="16">
          <span class="hits">60381</span>
          
          <code class="ruby">    @status = status</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="17">
          <span class="hits">60381</span>
          
          <code class="ruby">    @created_at = Time.parse(created_at)</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="18">
          <span class="hits">60381</span>
          
          <code class="ruby">    @updated_at = Time.parse(updated_at)</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="19">
          <span class="hits">60381</span>
          
          <code class="ruby">    @merchant_id = merchant_id</code>
        </li>
      
        <li class="covered" data-hits="60381" data-linenumber="20">
          <span class="hits">60381</span>
          
          <code class="ruby">    @inr = inr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    inr.fetch_merchant_from_invoice_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def items</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    inr.fetch_items_from_invoice_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def transactions</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="32">
          <span class="hits">12</span>
          
          <code class="ruby">    inr.fetch_transactions_from_invoice_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def customer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    inr.fetch_customer_from_invoice_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_items</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">    inr.fetch_invoice_items_from_invoice_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_paid_in_full?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="44">
          <span class="hits">10</span>
          
          <code class="ruby">    trans = transactions</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="45">
          <span class="hits">10</span>
          
          <code class="ruby">    trans.any? do |transaction|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">      transaction.result == &quot;success&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def total</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    inv_items = invoice_items</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    prices = inv_items.map do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">      num = (invoice_item.quantity.to_i * invoice_item.unit_price)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">      BigDecimal.new(num)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    prices.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="5d313736edf88a18e6d2769e0eca890134192374">
  <div class="header">
    <h3>lib/invoice_item.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceItem</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">              :item_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">              :invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :quantity,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :irr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, item_id, invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                quantity, unit_price, created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                updated_at, iir)</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="14">
          <span class="hits">262394</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="15">
          <span class="hits">262394</span>
          
          <code class="ruby">    @item_id = item_id</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="16">
          <span class="hits">262394</span>
          
          <code class="ruby">    @invoice_id = invoice_id</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="17">
          <span class="hits">262394</span>
          
          <code class="ruby">    @quantity = quantity</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="18">
          <span class="hits">262394</span>
          
          <code class="ruby">    @unit_price = BigDecimal.new(unit_price.insert(-3, &quot;.&quot;))</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="19">
          <span class="hits">262394</span>
          
          <code class="ruby">    @created_at = Time.parse(created_at)</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="20">
          <span class="hits">262394</span>
          
          <code class="ruby">    @updated_at = Time.parse(updated_at)</code>
        </li>
      
        <li class="covered" data-hits="262394" data-linenumber="21">
          <span class="hits">262394</span>
          
          <code class="ruby">    @iir = irr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def unit_price_to_dollars</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">    @unit_price.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="9e56dbf73d9637711968f6d02401065fa4ad41e4">
  <div class="header">
    <h3>lib/invoice_item_repository.rb</h3>
    <h4><span class="green">96.77 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_item&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceItemRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :invoice_items,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(invoice_items_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="10">
          <span class="hits">55</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="11">
          <span class="hits">55</span>
          
          <code class="ruby">    @invoice_items = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="12">
          <span class="hits">55</span>
          
          <code class="ruby">    contents = CSV.open invoice_items_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                        headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                        header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="15">
          <span class="hits">55</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="16">
          <span class="hits">262390</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="17">
          <span class="hits">262390</span>
          
          <code class="ruby">      item_id = row[:item_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="18">
          <span class="hits">262390</span>
          
          <code class="ruby">      invoice_id = row[:invoice_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="19">
          <span class="hits">262390</span>
          
          <code class="ruby">      quantity = row[:quantity]</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="20">
          <span class="hits">262390</span>
          
          <code class="ruby">      unit_price = row[:unit_price]</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="21">
          <span class="hits">262390</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="22">
          <span class="hits">262390</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="23">
          <span class="hits">262390</span>
          
          <code class="ruby">      invoice_item = InvoiceItem.new(id, item_id, invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">                                     quantity, unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">                                     created_at, updated_at, self)</code>
        </li>
      
        <li class="covered" data-hits="262390" data-linenumber="26">
          <span class="hits">262390</span>
          
          <code class="ruby">      @invoice_items &lt;&lt; invoice_item</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoice_items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(invoice_item_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoice_items.find do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="36">
          <span class="hits">11</span>
          
          <code class="ruby">      invoice_item.id == invoice_item_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_item_id(item_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoice_items.find_all do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="42">
          <span class="hits">20</span>
          
          <code class="ruby">      invoice_item.item_id == item_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="47">
          <span class="hits">33</span>
          
          <code class="ruby">    @invoice_items.find_all do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="371270" data-linenumber="48">
          <span class="hits">371270</span>
          
          <code class="ruby">      invoice_item.invoice_id == invoice_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@invoice_items.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="91e90f2c7f3d5b104608b81536243eef13f3f510">
  <div class="header">
    <h3>lib/invoice_repository.rb</h3>
    <h4><span class="green">97.22 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;loader&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include Loader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :invoices,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(invoice_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="12">
          <span class="hits">55</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="13">
          <span class="hits">55</span>
          
          <code class="ruby">    @invoice_file_path = invoice_file_path</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="14">
          <span class="hits">55</span>
          
          <code class="ruby">    @invoices = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="15">
          <span class="hits">55</span>
          
          <code class="ruby">    load_invoices(invoice_file_path, se)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">    @invoices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="23">
          <span class="hits">11</span>
          
          <code class="ruby">    @invoices.find do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="24">
          <span class="hits">85</span>
          
          <code class="ruby">      invoice.id == id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_customer_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">    @invoices.find_all do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="30">
          <span class="hits">52</span>
          
          <code class="ruby">      invoice.customer_id == customer_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="17364" data-linenumber="35">
          <span class="hits">17364</span>
          
          <code class="ruby">    @invoices.find_all do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="86395464" data-linenumber="36">
          <span class="hits">86395464</span>
          
          <code class="ruby">      invoice.merchant_id == merchant_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_status(status)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoices.find_all do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="42">
          <span class="hits">26</span>
          
          <code class="ruby">      invoice.status == status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchant_from_invoice_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    se.fetch_merchant_from_invoice_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">    se.fetch_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_transactions_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="55">
          <span class="hits">12</span>
          
          <code class="ruby">    se.fetch_transactions_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_customer_from_invoice_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    se.fetch_customer_from_invoice_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoice_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="63">
          <span class="hits">11</span>
          
          <code class="ruby">    se.fetch_invoice_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@invoices.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="325531b5c612c5244e32fe2420831ae655b2f596">
  <div class="header">
    <h3>lib/item.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class Item</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :description,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">              :merchant_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">              :ir</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, name, description, unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">                created_at, updated_at, merchant_id, ir)</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="16">
          <span class="hits">18276</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="17">
          <span class="hits">18276</span>
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="18">
          <span class="hits">18276</span>
          
          <code class="ruby">    @description = description</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="19">
          <span class="hits">18276</span>
          
          <code class="ruby">    @unit_price = BigDecimal.new(unit_price.insert(-3, &quot;.&quot;))</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="20">
          <span class="hits">18276</span>
          
          <code class="ruby">    @created_at = Time.parse(created_at)</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="21">
          <span class="hits">18276</span>
          
          <code class="ruby">    @updated_at = Time.parse(updated_at)</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="22">
          <span class="hits">18276</span>
          
          <code class="ruby">    @merchant_id = merchant_id</code>
        </li>
      
        <li class="covered" data-hits="18276" data-linenumber="23">
          <span class="hits">18276</span>
          
          <code class="ruby">    @ir = ir</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def unit_price_to_dollars</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    @unit_price.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    ir.fetch_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="697c08fe4e249c73626b06f67c2f1db4f71fd6cd">
  <div class="header">
    <h3>lib/item_repository.rb</h3>
    <h4><span class="green">97.14 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines. 
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;item&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;loader&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class ItemRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Loader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :items,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(items_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="13">
          <span class="hits">58</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="14">
          <span class="hits">58</span>
          
          <code class="ruby">    @items_file_path = items_file_path</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="15">
          <span class="hits">58</span>
          
          <code class="ruby">    @items = []</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="16">
          <span class="hits">58</span>
          
          <code class="ruby">    load_items(items_file_path, se)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    @items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(item_id)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="24">
          <span class="hits">15</span>
          
          <code class="ruby">    @items.find do |item|</code>
        </li>
      
        <li class="covered" data-hits="7249" data-linenumber="25">
          <span class="hits">7249</span>
          
          <code class="ruby">      item.id == item_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_name(item_name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    @items.find do |item|</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="31">
          <span class="hits">13</span>
          
          <code class="ruby">      item.name.downcase == item_name.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_with_description(fragment)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    @items.find_all do |item|</code>
        </li>
      
        <li class="covered" data-hits="4101" data-linenumber="37">
          <span class="hits">4101</span>
          
          <code class="ruby">      item.description.downcase.include?(fragment.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_price(price)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    @items.find_all do |item|</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="43">
          <span class="hits">22</span>
          
          <code class="ruby">      item.unit_price == price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_price_in_range(range)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    @items.find_all do |item|</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="49">
          <span class="hits">22</span>
          
          <code class="ruby">      range.include?(item.unit_price)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id(id)</code>
        </li>
      
        <li class="covered" data-hits="1457" data-linenumber="54">
          <span class="hits">1457</span>
          
          <code class="ruby">    @items.find_all do |item|</code>
        </li>
      
        <li class="covered" data-hits="1949683" data-linenumber="55">
          <span class="hits">1949683</span>
          
          <code class="ruby">      item.merchant_id == id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    se.fetch_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@items.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f72e5a51272f54137c5a15a83456c458388d684a">
  <div class="header">
    <h3>lib/loader.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines. 
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Loader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_invoices(invoice_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="4">
          <span class="hits">55</span>
          
          <code class="ruby">    contents = CSV.open invoice_file_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">                 headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">                 header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="7">
          <span class="hits">55</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="8">
          <span class="hits">60379</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="9">
          <span class="hits">60379</span>
          
          <code class="ruby">      customer_id = (row[:customer_id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="10">
          <span class="hits">60379</span>
          
          <code class="ruby">      status = (row[:status]).to_sym</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="11">
          <span class="hits">60379</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="12">
          <span class="hits">60379</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="13">
          <span class="hits">60379</span>
          
          <code class="ruby">      merchant_id = (row[:merchant_id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="14">
          <span class="hits">60379</span>
          
          <code class="ruby">      invoice = Invoice.new(id, customer_id, status,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">                            created_at, updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">                            merchant_id, self)</code>
        </li>
      
        <li class="covered" data-hits="60379" data-linenumber="17">
          <span class="hits">60379</span>
          
          <code class="ruby">      @invoices &lt;&lt; invoice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_items(items_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="22">
          <span class="hits">58</span>
          
          <code class="ruby">    contents = CSV.open items_file_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">                 headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">                 header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="25">
          <span class="hits">58</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="26">
          <span class="hits">18266</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="27">
          <span class="hits">18266</span>
          
          <code class="ruby">      name = row[:name]</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="28">
          <span class="hits">18266</span>
          
          <code class="ruby">      description = row[:description]</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="29">
          <span class="hits">18266</span>
          
          <code class="ruby">      unit_price = row[:unit_price]</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="30">
          <span class="hits">18266</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="31">
          <span class="hits">18266</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="32">
          <span class="hits">18266</span>
          
          <code class="ruby">      merchant_id = (row[:merchant_id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="33">
          <span class="hits">18266</span>
          
          <code class="ruby">      item = Item.new(id, name, description, unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">                     created_at, updated_at, merchant_id, self)</code>
        </li>
      
        <li class="covered" data-hits="18266" data-linenumber="35">
          <span class="hits">18266</span>
          
          <code class="ruby">      @items &lt;&lt; item</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_merchants(merchants_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="40">
          <span class="hits">55</span>
          
          <code class="ruby">    contents = CSV.open merchants_file_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">                 headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">                 header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="43">
          <span class="hits">55</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="44">
          <span class="hits">6721</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="45">
          <span class="hits">6721</span>
          
          <code class="ruby">      name = row[:name]</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="46">
          <span class="hits">6721</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="47">
          <span class="hits">6721</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="48">
          <span class="hits">6721</span>
          
          <code class="ruby">      merchant = Merchant.new(id, name, created_at, updated_at, self)</code>
        </li>
      
        <li class="covered" data-hits="6721" data-linenumber="49">
          <span class="hits">6721</span>
          
          <code class="ruby">      @merchants &lt;&lt; merchant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4150a4dab4aba54017e8fd31239fb8520c82d866">
  <div class="header">
    <h3>lib/merchant.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">              :name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :mr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, name, created_at, updated_at, mr)</code>
        </li>
      
        <li class="covered" data-hits="6726" data-linenumber="9">
          <span class="hits">6726</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="6726" data-linenumber="10">
          <span class="hits">6726</span>
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="covered" data-hits="6726" data-linenumber="11">
          <span class="hits">6726</span>
          
          <code class="ruby">    @created_at = created_at</code>
        </li>
      
        <li class="covered" data-hits="6726" data-linenumber="12">
          <span class="hits">6726</span>
          
          <code class="ruby">    @updated_at = updated_at</code>
        </li>
      
        <li class="covered" data-hits="6726" data-linenumber="13">
          <span class="hits">6726</span>
          
          <code class="ruby">    @mr = mr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def items</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    mr.fetch_merchant_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices</code>
        </li>
      
        <li class="covered" data-hits="2376" data-linenumber="21">
          <span class="hits">2376</span>
          
          <code class="ruby">    mr.fetch_invoices(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def customers</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">    mr.fetch_customers_from_merchant_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d91e41168837f41f9a545441447274cb377d7178">
  <div class="header">
    <h3>lib/merchant_repository.rb</h3>
    <h4><span class="green">96.67 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;merchant&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;loader&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class MerchantRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Loader</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :merchants,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(merchants_file_path, se)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="13">
          <span class="hits">55</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="14">
          <span class="hits">55</span>
          
          <code class="ruby">    @merchants = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="15">
          <span class="hits">55</span>
          
          <code class="ruby">    @merchants_file_path = merchants_file_path</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="16">
          <span class="hits">55</span>
          
          <code class="ruby">    load_merchants(merchants_file_path, se)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    @merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="24">
          <span class="hits">19</span>
          
          <code class="ruby">    @merchants.find do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="25">
          <span class="hits">138</span>
          
          <code class="ruby">      merchant.id == merchant_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_name(merchant_name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    @merchants.find do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="31">
          <span class="hits">27</span>
          
          <code class="ruby">      merchant.name.downcase == merchant_name.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_name(fragment)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    @merchants.find_all do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="1425" data-linenumber="37">
          <span class="hits">1425</span>
          
          <code class="ruby">      merchant.name.downcase.include?(fragment.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    se.fetch_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoices(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2376" data-linenumber="46">
          <span class="hits">2376</span>
          
          <code class="ruby">    se.fetch_invoices_for_merchant(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_customers_from_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    se.fetch_customers_from_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c165f8f1e439e50d51675a78b325e296fe747620">
  <div class="header">
    <h3>lib/sales_analyst.rb</h3>
    <h4><span class="green">98.32 %</span> covered</h4>
    <div>
      <b>179</b> relevant lines. 
      <span class="green"><b>176</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;sales_engine&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;calculator&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class SalesAnalyst</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Math</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  include Calculator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(se)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="11">
          <span class="hits">20</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_items_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="15">
          <span class="hits">5</span>
          
          <code class="ruby">    (@se.call_items.count.to_f / @se.call_merchants.count.to_f).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_items_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_items = number_of_items_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    variance = get_variance_merchants(merchant_items)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    sqrt(variance.sum / (@se.call_merchants.count.to_f - 1)).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def cost_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    all_costs = get_all_costs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    variance = get_variance_item_costs(all_costs)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    sqrt(variance.sum / (all_costs.length - 1).to_f).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants_with_high_item_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    high_item_merchants = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    target = average_items_per_merchant +</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">             average_items_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_merchants.each do |merchant_obj|</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="35">
          <span class="hits">475</span>
          
          <code class="ruby">      merchant_id = merchant_obj.id</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="36">
          <span class="hits">475</span>
          
          <code class="ruby">      items = @se.items.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="37">
          <span class="hits">475</span>
          
          <code class="ruby">      if items.count &gt;= target</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="38">
          <span class="hits">52</span>
          
          <code class="ruby">        high_item_merchants &lt;&lt; merchant_obj</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    high_item_merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_item_price_for_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="476" data-linenumber="45">
          <span class="hits">476</span>
          
          <code class="ruby">    all_merchant_items = @se.items.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="476" data-linenumber="46">
          <span class="hits">476</span>
          
          <code class="ruby">    all_item_prices = all_merchant_items.map do |item|</code>
        </li>
      
        <li class="covered" data-hits="1377" data-linenumber="47">
          <span class="hits">1377</span>
          
          <code class="ruby">      item.unit_price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="476" data-linenumber="49">
          <span class="hits">476</span>
          
          <code class="ruby">    (all_item_prices.sum / all_item_prices.count).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_average_price_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    merchant_averages = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_merchants.each do |merchant_obj|</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="55">
          <span class="hits">475</span>
          
          <code class="ruby">      merchant_id = merchant_obj.id</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="56">
          <span class="hits">475</span>
          
          <code class="ruby">      merchant_averages &lt;&lt; average_item_price_for_merchant(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    (merchant_averages.sum / @se.call_merchants.count).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def golden_items</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    gold_items = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    target = average_price_per_item +</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">             (cost_standard_deviation * 2)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_items.each do |item|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="66">
          <span class="hits">11</span>
          
          <code class="ruby">      if item.unit_price &gt;= target</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">        gold_items &lt;&lt; item</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    gold_items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="954" data-linenumber="74">
          <span class="hits">954</span>
          
          <code class="ruby">    (@se.call_invoices.count.to_f / @se.call_merchants.count.to_f).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="78">
          <span class="hits">3</span>
          
          <code class="ruby">    merchant_invoices = number_of_invoices_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>
          
          <code class="ruby">    squares = get_squares_invoices(merchant_invoices)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="80">
          <span class="hits">3</span>
          
          <code class="ruby">    sqrt(squares.sum / (@se.call_merchants.count.to_f - 1)).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_merchants_by_invoice_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">    standard_deviation = average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_merchants.find_all do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="86">
          <span class="hits">475</span>
          
          <code class="ruby">      (merchant.invoices.count - average_invoices_per_merchant) &gt;=</code>
        </li>
      
        <li class="covered" data-hits="950" data-linenumber="87">
          <span class="hits">950</span>
          
          <code class="ruby">      (standard_deviation * 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  def bottom_merchants_by_invoice_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">    standard_deviation = average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_merchants.find_all do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="475" data-linenumber="94">
          <span class="hits">475</span>
          
          <code class="ruby">      (merchant.invoices.count - average_invoices_per_merchant) &lt;=</code>
        </li>
      
        <li class="covered" data-hits="950" data-linenumber="95">
          <span class="hits">950</span>
          
          <code class="ruby">      -(standard_deviation * 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_per_day_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_hash = @se.invoices_per_day</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    squares = get_squares_invoices_per_day(invoices_hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    sqrt(squares.sum / 6).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_days_by_invoice_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    top_days = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    standard_deviation = invoice_per_day_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_by_day = @se.invoices_per_day</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_by_day.keys.find_all do |day|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="110">
          <span class="hits">5</span>
          
          <code class="ruby">      if (invoices_by_day[day] - average_invoices_per_day) &gt; standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">        top_days &lt;&lt; day</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_status(status)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="117">
          <span class="hits">3</span>
          
          <code class="ruby">    total_invoices = @se.call_invoices.count</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="118">
          <span class="hits">3</span>
          
          <code class="ruby">    ((@se.invoices_by_status[status].to_f / total_invoices) * 100.0).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def total_revenue_by_date(date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_on_date = get_invoices_on_date(date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_ids = get_invoice_ids(invoices_on_date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items = @se.fetch_invoice_items_with_invoice_id(invoice_ids.uniq)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">    sum_invoice_items(invoice_items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_invoices_on_date(date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.call_invoices.find_all do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="130">
          <span class="hits">13</span>
          
          <code class="ruby">      invoice.created_at.strftime(&quot;%Y-%m-%d&quot;) == date.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_invoice_ids(invoices_on_date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices_on_date.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">      invoice.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def sum_invoice_items(invoice_items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    invoice_items[0].map do |item|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="142">
          <span class="hits">10</span>
          
          <code class="ruby">      (item.unit_price * item.quantity.to_i)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="143">
          <span class="hits">2</span>
          
          <code class="ruby">    end.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_revenue_earners(x = 20)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="147">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_ids = @se.call_merchants.map do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="148">
          <span class="hits">26</span>
          
          <code class="ruby">      merchant.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="150">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_invoice_hash = {}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="151">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_ids.each do |merchant_id|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="152">
          <span class="hits">26</span>
          
          <code class="ruby">      merchant_invoice_hash[merchant_id] =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">      @se.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    new_hash = {}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="156">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_invoice_hash.each do |merchant_id, invoice_array|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="157">
          <span class="hits">26</span>
          
          <code class="ruby">      new_hash[merchant_id] = hash_converter(invoice_array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="159">
          <span class="hits">2</span>
          
          <code class="ruby">    new_array = new_hash.sort_by(&amp;:last)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="160">
          <span class="hits">2</span>
          
          <code class="ruby">    results = []</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="161">
          <span class="hits">2</span>
          
          <code class="ruby">    counter = x</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="162">
          <span class="hits">2</span>
          
          <code class="ruby">    while counter &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="163">
          <span class="hits">6</span>
          
          <code class="ruby">      results &lt;&lt; new_array.pop</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="164">
          <span class="hits">6</span>
          
          <code class="ruby">      counter -= 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="166">
          <span class="hits">2</span>
          
          <code class="ruby">    results.map! do |result|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="167">
          <span class="hits">6</span>
          
          <code class="ruby">      @se.merchants.find_by_id(result[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  def hash_converter(invoice_array)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="172">
          <span class="hits">26</span>
          
          <code class="ruby">    invoice_ids = get_invoice_ids_from_array(invoice_array)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="173">
          <span class="hits">26</span>
          
          <code class="ruby">    invoice_items = get_invoice_items(invoice_ids)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="174">
          <span class="hits">26</span>
          
          <code class="ruby">    sum_prices(invoice_items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_invoice_ids_from_array(invoice_array)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="178">
          <span class="hits">26</span>
          
          <code class="ruby">    invoice_array.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="179">
          <span class="hits">8</span>
          
          <code class="ruby">      if invoice.is_paid_in_full?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">        invoice.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_invoice_items(invoice_ids_array)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="186">
          <span class="hits">26</span>
          
          <code class="ruby">    invoice_ids_array.map do |invoice_id|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="187">
          <span class="hits">8</span>
          
          <code class="ruby">      @se.invoices.fetch_invoice_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">  def sum_prices(invoice_items_array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    invoice_items_array.map do |invoice_item_array|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="193">
          <span class="hits">8</span>
          
          <code class="ruby">      iterate_invoice_items(invoice_item_array)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="194">
          <span class="hits">26</span>
          
          <code class="ruby">    end.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="197">
          <span class="hits">1</span>
          
          <code class="ruby">  def iterate_invoice_items(invoice_item_array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">    invoice_item_array.map do |invoice_item|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      (invoice_item.unit_price * invoice_item.quantity.to_i)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="200">
          <span class="hits">8</span>
          
          <code class="ruby">    end.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">  def revenue_by_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices = @se.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items = iterate_invoices(invoices)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="206">
          <span class="hits">1</span>
          
          <code class="ruby">    sum_invoice_items(invoice_items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">  def iterate_invoices(invoice_collection)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="210">
          <span class="hits">3</span>
          
          <code class="ruby">    invoice_collection.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="211">
          <span class="hits">17</span>
          
          <code class="ruby">      @se.invoice_items.find_all_by_invoice_id(invoice.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="215">
          <span class="hits">1</span>
          
          <code class="ruby">  def most_sold_item_for_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices = @se.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items = iterate_invoices(invoices)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">    item_ids = get_items_from_array(invoice_items).flatten</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="219">
          <span class="hits">1</span>
          
          <code class="ruby">    hash = get_hash(item_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">    items = get_max(hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">    get_items(items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_items_from_array(invoice_items_array)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items_array.map do |array|</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="226">
          <span class="hits">15</span>
          
          <code class="ruby">      get_item_ids(array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_item_ids(array)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="231">
          <span class="hits">15</span>
          
          <code class="ruby">    array.map do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="232">
          <span class="hits">61</span>
          
          <code class="ruby">      invoice_item.item_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_hash(item_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="237">
          <span class="hits">1</span>
          
          <code class="ruby">    count = {}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">    item_ids.each do |item_id|</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="239">
          <span class="hits">61</span>
          
          <code class="ruby">      if count.key?(item_id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="240">
          <span class="hits">3</span>
          
          <code class="ruby">        count[item_id] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="242">
          <span class="hits">58</span>
          
          <code class="ruby">      count[item_id] = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>
          
          <code class="ruby">    count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="248">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_max(hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="249">
          <span class="hits">1</span>
          
          <code class="ruby">    max = hash.values.max</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="250">
          <span class="hits">1</span>
          
          <code class="ruby">    items_with_count = hash.find_all do |item_id, count|</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="251">
          <span class="hits">58</span>
          
          <code class="ruby">      count == max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="253">
          <span class="hits">1</span>
          
          <code class="ruby">    items_with_count.map do |array|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>
          
          <code class="ruby">      array[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="258">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_items(items)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="259">
          <span class="hits">1</span>
          
          <code class="ruby">    items.map do |id|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">      @se.items.find_by_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">  def best_item_for_merchant(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    #get invoices for merchant id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">    #get invoice items for each invoice id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices = @se.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="268">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items = iterate_invoices(invoices).flatten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    #find revenue for each invoice item and make hash with item id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    #add revenues that have same item id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">    revenue_hash = create_revenue_hash(invoice_items)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">    #sort by revenues</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    #return item</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">    var = get_max_revenue(revenue_hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="277">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_revenue_hash(invoice_items)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">    revenue_hash = {}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="279">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_items.each do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="280">
          <span class="hits">2</span>
          
          <code class="ruby">      id = invoice_item.item_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="281">
          <span class="hits">2</span>
          
          <code class="ruby">      revenue = (invoice_item.quantity.to_i * invoice_item.unit_price)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="282">
          <span class="hits">2</span>
          
          <code class="ruby">      if revenue_hash.key?(id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">        revenue_hash[id] += revenue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="285">
          <span class="hits">2</span>
          
          <code class="ruby">        revenue_hash[id] = revenue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="288">
          <span class="hits">1</span>
          
          <code class="ruby">    revenue_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="291">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_max_revenue(revenue_hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="292">
          <span class="hits">1</span>
          
          <code class="ruby">    max = revenue_hash.values.max</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="293">
          <span class="hits">1</span>
          
          <code class="ruby">    revenue_array = revenue_hash.find do |item_id, revenue|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">      revenue == max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="296">
          <span class="hits">1</span>
          
          <code class="ruby">    @se.items.find_by_id(revenue_array[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">  # def get_max(hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  #   max = hash.values.max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">  #   items_with_count = hash.find_all do |item_id, count|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">  #     count == max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">  #   items_with_count.map do |array|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">  #     array[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="faffb49bd05f238e2cbf2a87f2077ae98e0836be">
  <div class="header">
    <h3>lib/sales_engine.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>84</b> relevant lines. 
      <span class="green"><b>84</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;CSV&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;item_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;merchant_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_item_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;transaction_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;customer_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">class SalesEngine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.from_csv(hash)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="13">
          <span class="hits">49</span>
          
          <code class="ruby">    SalesEngine.new(hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :items,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">              :merchants,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">              :invoices,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">              :invoice_items,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">              :transactions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">              :customers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(hash)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="24">
          <span class="hits">49</span>
          
          <code class="ruby">    @items = ItemRepository.new(hash[:items], self)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="25">
          <span class="hits">49</span>
          
          <code class="ruby">    @merchants = MerchantRepository.new(hash[:merchants], self)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="26">
          <span class="hits">49</span>
          
          <code class="ruby">    @invoices = InvoiceRepository.new(hash[:invoices], self)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="27">
          <span class="hits">49</span>
          
          <code class="ruby">    @invoice_items = InvoiceItemRepository.new(hash[:invoice_items], self)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="28">
          <span class="hits">49</span>
          
          <code class="ruby">    @transactions = TransactionRepository.new(hash[:transactions], self)</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="29">
          <span class="hits">49</span>
          
          <code class="ruby">    @customers = CustomerRepository.new(hash[:customers], self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    pass_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def pass_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    @items.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    pass_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def pass_items_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">    @merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoices_for_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2376" data-linenumber="49">
          <span class="hits">2376</span>
          
          <code class="ruby">    @invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchant_from_invoice_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    @merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">    invoice_items = @invoice_items.find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">    item_id_array = invoice_items.map do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="59">
          <span class="hits">8</span>
          
          <code class="ruby">      invoice_item.item_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">    fetch_items_from_collection_of_item_ids(item_id_array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_items_from_collection_of_item_ids(item_id_array)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    item_id_array.map do |item_id|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="66">
          <span class="hits">8</span>
          
          <code class="ruby">      items.find_by_id(item_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_transactions_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="71">
          <span class="hits">12</span>
          
          <code class="ruby">    @transactions.find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_customer_from_invoice_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    @customers.find_by_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoice_from_transaction_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    @invoices.find_by_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_customers_from_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="83">
          <span class="hits">2</span>
          
          <code class="ruby">    invoices = @invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">    customer_id_array = invoices.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">      invoice.customer_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    fetch_customers_with_customer_id(customer_id_array.uniq)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_customers_with_customer_id(customer_id_array)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>
          
          <code class="ruby">    customer_id_array.map do |customer_id|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">       customers.find_by_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchants_from_customer_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="97">
          <span class="hits">2</span>
          
          <code class="ruby">    invoices = @invoices.find_all_by_customer_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="98">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_id_array = invoices.map do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="99">
          <span class="hits">4</span>
          
          <code class="ruby">      invoice.merchant_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="101">
          <span class="hits">2</span>
          
          <code class="ruby">    fetch_merchants_with_merchant_id(merchant_id_array)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_merchants_with_merchant_id(merchant_id_array)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="105">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_id_array.map do |merchant_id|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="106">
          <span class="hits">4</span>
          
          <code class="ruby">       merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoice_items_from_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="111">
          <span class="hits">11</span>
          
          <code class="ruby">    @invoice_items.find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  def call_merchants</code>
        </li>
      
        <li class="covered" data-hits="977" data-linenumber="115">
          <span class="hits">977</span>
          
          <code class="ruby">    @merchants.merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">  def call_items</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="119">
          <span class="hits">9</span>
          
          <code class="ruby">    @items.items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">  def call_invoices</code>
        </li>
      
        <li class="covered" data-hits="970" data-linenumber="123">
          <span class="hits">970</span>
          
          <code class="ruby">    @invoices.invoices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices_per_day</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="127">
          <span class="hits">3</span>
          
          <code class="ruby">    call_invoices.reduce({}) do |days, invoice|</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="128">
          <span class="hits">39</span>
          
          <code class="ruby">      if days.has_key?(invoice.created_at.strftime(&#39;%A&#39;))</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="129">
          <span class="hits">24</span>
          
          <code class="ruby">        days[invoice.created_at.strftime(&#39;%A&#39;)] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="131">
          <span class="hits">15</span>
          
          <code class="ruby">        days[invoice.created_at.strftime(&#39;%A&#39;)] = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="133">
          <span class="hits">39</span>
          
          <code class="ruby">      days</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices_by_status</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="138">
          <span class="hits">3</span>
          
          <code class="ruby">    invoices.all.reduce({}) do |status, invoice|</code>
        </li>
      
        <li class="covered" data-hits="14955" data-linenumber="139">
          <span class="hits">14955</span>
          
          <code class="ruby">      if status.has_key?(invoice.status.to_sym)</code>
        </li>
      
        <li class="covered" data-hits="14946" data-linenumber="140">
          <span class="hits">14946</span>
          
          <code class="ruby">        status[invoice.status.to_sym] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="142">
          <span class="hits">9</span>
          
          <code class="ruby">        status[invoice.status.to_sym] = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="14955" data-linenumber="144">
          <span class="hits">14955</span>
          
          <code class="ruby">      status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoice_items_with_invoice_id(invoice_array)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">    invoice_array.map do |invoice_id|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">      invoice_items.find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8cbea7df2b292223c8a266b837b0512a23dc93da">
  <div class="header">
    <h3>lib/transaction.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Transaction</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">              :invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">              :credit_card_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :credit_card_expiration_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :result,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :tr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(id, invoice_id, credit_card_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                credit_card_expiration_date, result,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                created_at, updated_at, tr)</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="14">
          <span class="hits">60262</span>
          
          <code class="ruby">    @id = id</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="15">
          <span class="hits">60262</span>
          
          <code class="ruby">    @invoice_id = invoice_id</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="16">
          <span class="hits">60262</span>
          
          <code class="ruby">    @credit_card_number = credit_card_number</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="17">
          <span class="hits">60262</span>
          
          <code class="ruby">    @credit_card_expiration_date = credit_card_expiration_date</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="18">
          <span class="hits">60262</span>
          
          <code class="ruby">    @result = result</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="19">
          <span class="hits">60262</span>
          
          <code class="ruby">    @created_at = Time.parse(created_at)</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="20">
          <span class="hits">60262</span>
          
          <code class="ruby">    @updated_at = Time.parse(updated_at)</code>
        </li>
      
        <li class="covered" data-hits="60262" data-linenumber="21">
          <span class="hits">60262</span>
          
          <code class="ruby">    @tr = tr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    tr.fetch_invoice_from_transaction_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ff1e803e4ac601497a537845851cded6006f66f3">
  <div class="header">
    <h3>lib/transaction_repository.rb</h3>
    <h4><span class="green">97.22 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;transaction&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;pry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class TransactionRepository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :transactions,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(transactions_path, se)</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="10">
          <span class="hits">56</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="11">
          <span class="hits">56</span>
          
          <code class="ruby">    @transactions = []</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="12">
          <span class="hits">56</span>
          
          <code class="ruby">    contents = CSV.open transactions_path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                        headers: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                        header_converters: :symbol</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="15">
          <span class="hits">56</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="16">
          <span class="hits">60260</span>
          
          <code class="ruby">      id = (row[:id]).to_i</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="17">
          <span class="hits">60260</span>
          
          <code class="ruby">      invoice_id = row[:invoice_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="18">
          <span class="hits">60260</span>
          
          <code class="ruby">      credit_card_number = row[:credit_card_number].to_i</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="19">
          <span class="hits">60260</span>
          
          <code class="ruby">      credit_card_expiration_date = row[:credit_card_expiration_date]</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="20">
          <span class="hits">60260</span>
          
          <code class="ruby">      result = row[:result]</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="21">
          <span class="hits">60260</span>
          
          <code class="ruby">      created_at = row[:created_at]</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="22">
          <span class="hits">60260</span>
          
          <code class="ruby">      updated_at = row[:updated_at]</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="23">
          <span class="hits">60260</span>
          
          <code class="ruby">      transaction = Transaction.new(id, invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">                                    credit_card_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">                                    credit_card_expiration_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">                                    result, created_at, updated_at, self)</code>
        </li>
      
        <li class="covered" data-hits="60260" data-linenumber="27">
          <span class="hits">60260</span>
          
          <code class="ruby">      @transactions &lt;&lt; transaction</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    @transactions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(transaction_id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    @transactions.find do |transaction_obj|</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="37">
          <span class="hits">13</span>
          
          <code class="ruby">      transaction_obj.id == transaction_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="42">
          <span class="hits">14</span>
          
          <code class="ruby">    @transactions.find_all do |transaction_obj|</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="43">
          <span class="hits">140</span>
          
          <code class="ruby">      transaction_obj.invoice_id == invoice_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_credit_card_number(credit_card_number)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    @transactions.find_all do |transaction_obj|</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="49">
          <span class="hits">20</span>
          
          <code class="ruby">      transaction_obj.credit_card_number == credit_card_number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_result(result)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">    @transactions.find_all do |transaction_obj|</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="55">
          <span class="hits">20</span>
          
          <code class="ruby">      transaction_obj.result == result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_invoice_from_transaction_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    se.fetch_invoice_from_transaction_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@transactions.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
